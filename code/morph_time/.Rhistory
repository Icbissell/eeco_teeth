c
glm(a,b)
xvec <- runif(10)
xvec
ls()
rm(xvec)
rm(a)
ls
ls()
v <- sample(1:9, 5, replace = TRUE)
v
set.seed(2)
v <- sample(1:9, 5, replace = TRUE)
v
v
v <- sample(1:9, 5, replace = TRUE)
v
v
v
xvec = c(1,2,3,4,5)
(xvec = c(1,2,3,4,5))
?pnorm()
pnorm(107.5, mean = 100, sd = 15)
1 - pnorm(107.5, mean = 100, sd = 15)
pnorm(70, mean = 100, sd = 15)
pnorm(130, mean = 100, sd = 15)  - pnorm(70, mean = 100, sd = 15)
pnorm(130, mean = 100, sd = 15)
1 - 0.9772499^2
1 - 0.9772499
pnorm(107.5, mean = 100, sd = 15)
1- pnorm(107.5, mean = 100, sd = 15)
(1 - 0.9772499^2)*0.3085375
knitr::opts_chunk$set(echo = TRUE)
#Will you take a COVID-19 vaccine when it's available?
#Here's our data:
Yes <- rep("Yes", 9)
No <- rep("No", 5)
No_Idea <- rep("No idea", 11)
survey <- c(Yes, No, No_Idea)
A <- rep("Yes", 6)
B <- rep("No", 5)
C <- rep("Yes", 7)
D <- rep("No", 7)
US <- c(A,B,C,D)
data <- data.frame(survey, US)
View(data)
#First, create a table of the data:
table(data)
#Will you take a COVID-19 vaccine when it's available?
#Here's our data:
Yes <- rep("Yes", 9)
No <- rep("No", 5)
No_Idea <- rep("No idea", 11)
survey <- c(Yes, No, No_Idea)
A <- rep("Yes", 6)
B <- rep("No", 5)
C <- rep("Yes", 7)
D <- rep("No", 7)
US <- c(A,B,C,D)
data <- data.frame(survey, US)
View(data)
#First, create a table of the data:
table(data)
pie(table(survey))
percentages <- prop.table(table(survey))
labels <- c("No", "No Idea", "Yes")
pie(percentages, cex.main = .75, labels = labels, main="Will you take a COVID-19 vaccine when it's available?")
?subset
barplot(survey)
barplot(tabl(survey)
barplot(table(survey)
counts <- table(survey)
barplot(counts)
counts <- table(data$survey, data$US)
counts
barplot(counts)
barplot(counts, cex.main = .75, ylim = range(c(0,20)), main = "Will you take a COVID-19 vaccine as soon as it becomes available?", xlab="Response")
data <- c(.1, .2, .5, 1, 1.7, 2.6, 4.0, 6.0, 9.5, 45)
#The handwritten boxplot should look like this:
boxplot(data, main = "Boxplot of Data", horizontal = TRUE)
COTININE <- read.csv("http://reuningscherer.net/stat10x/data/cotinine.csv", header = T)
#View(COTININE)
nrow(COTININE)
summary(COTININE)
mean(COTININE)
?mean
mean(COTININE$ETS)
SD(COTININE$ETS)
sd(COTININE$ETS)
?pnorm()
pnorm(0.95, mean(COTININE$ETS), sd(COTININE$ETS))
mean <- mean(COTININE$ETS)
SD <- sd(COTININE$ETS)
lower_bound <- mean - 2*SD
upper_bound <- mean + 2*SD
#Here's the lower bound:
lower_bound
#Here's the upper bound:
upper_bound
?barplot()
barplot(COTININE$SMOKER) + barplot(COTININE$ETS)
boxplot(COTININE$SMOKER) + boxplot(COTININE$ETS)
boxplot(COTININE$SMOKER)
boxplot(COTININE$ETS)
boxplot(COTININE)
?pnorm
pnorm(72.4, mean = 71.5, sd = 2.7)
pnorm(71.5, mean = 71.5, sd = 2.7)
pnorm(76, mean = 71.5, sd = 2.7)
pnorm(79.6, mean = 71.5, sd = 2.7)
pnorm(76, mean = 72.4, sd = 3.6)
pnorm(72.4, mean = 72.4, sd = 3.6)
pnorm(79.6, mean = 72.4, sd = 3.6)
pnorm(68.8, mean = 72.4, sd = 3.6)
clear
cl
knitr::opts_chunk$set(echo = TRUE)
library(ape)
phy = read.ftable("18s.aligned.fasta.treefile")
phy_2 = read.tree("alignment.fasta.treefile")
plot(phy_2)
phy_2 = read.tree("alignment.fasta.treefile")
phy_2 <- drop.tip(c(XR_002890936.1_Physeter_catodon))
phy_2 = read.tree("alignment.fasta.treefile")
#phy_2 <- drop.tip(c(XR_002890936.1_Physeter_catodon))
plot(phy_2)
phy_2 = read.tree("alignment.fasta.treefile")
phy_2 <- drop.tip(c(XR_002890936.1 Physeter catodon))
phy_2 = read.tree("alignment.fasta.treefile")
phy_2 <- drop.tip(c("XR_002890936.1_Physeter_catodon"))
phy_2 = read.tree("alignment.fasta.treefile")
phy_2 <- drop.tip(c("XR_002890936.1 Physeter catodon"))
phy_2 = read.tree("alignment.fasta.treefile")
phy_3 <- drop.tip(phy_2, c("XR_002890936.1_Physeter_catodon"))
plot(phy_3)
p
x <- seq(-10, 10, by = .01)
y <- dnorm(x, mean = 4, sd = 3.202)
plot(x,y)
pnorm(0, mean = 4, sd = 3.202)
1- pnorm(0, mean = 4, sd = 3.202)
dbinom(140, size = 250, prob = 0.5)
dbinom(125, size = 250, prob = 0.5)
probs = dbinom(c(0:250), 250, 0.5)
plot(c(0:250), probs)
pbinom(140, 250, 0.5)
1-pbinom(140, 250, 0.5)
exp = 250*0.5
var = 250*0.5*0.5
sd = sqrt(var)
z = (140-exp)/sd
10pnorm(z)
1-pnorm(z)
binom.test(140, 250, p = 0.5)
x = c(1:6)
y = (6^c/factorial(c))*exp(-6)
y = (power(6,c)/factorial(c))*exp(-6)
c
y = (power(6,x)/factorial(x))*exp(-6)
x
power(6,x)
6^x
y = ((6^x)/factorial(x))*exp(-6)
plot(x,y)
sum(y)
x = c(1:1000)
y = dnorm(x, mean = 54, sd = sqrt(54))
plot(x,y)
?seq
x = seq(0,200, by=0.1)
y = dnorm(x, mean = 54, sd = sqrt(54))
plot(x,y)
1 - pnorm(65, 54, sqrt(54))
1 - pnorm(65, 54, 54)
1/sqrt(1000)
1/sqrt(20)
pbinom(4, 5, 0.8)
1- dbinom(18, 20, 0.8)
dbinom(18, 20, 0.8)
dbinom(4, 5, 0.8)
1- pbinom(18, 20, 0.8)
dbinom(140, 250, 0.3)
dbinom(140, 250, 0.5)
pbinom(140, 250, 0.5)
?pbinom
1- pbinom(140, 250, 0.5)
1- dbinom(140, 250, 0.5)
dbinom(140, 250, 0.5)
1- pbinom(140, 250, 0.5)
pbinom(140, 250, 0.5)
pbinom(139, 250, 0.5)
1- pbinom(139, 250, 0.5)
1- pbinom(17, 20, 0.8)
1- pbinom(18, 20, 0.8)
dbinom(18, 20, 0.8)+dbinom(19, 20, 0.8)+dbinom(20, 20, 0.8)
?plot
library(ape)
?plot
?ape
rProp <- 38/380
iProp <- 246/573
prop.test(x = c(rProp, iProp), n = c(380, 573), conf.level = 0.95, correct = FALSE)
prop.test(x = c(rProp, iProp), n = c(380, 573), conf.level = .95, correct = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(ape)
# Load data import, wrangling, and plotting tools from the Tidyverse.
# See https://r4ds.had.co.nz/ for more
library(tidyverse)
library(magrittr)
trace_jc =
read_tsv("output_jc/primates_cytb_JC.log")
trace_jc =
read_tsv("output_jc/primates_cytb_JC.log")
trace_jc =
read_tsv("output_jc/primates_cytb_JC.log")
trace_jc %<>%                           # Read the data
mutate(Replicate_ID = as.factor(Replicate_ID))                       # Convert the replicate id to a factor
trace_jc %<>% mutate(Iteration = Iteration %/% length(levels(trace_jc$Replicate_ID)))  # The iterations are sequenctial across all replicates. Rescale them so that they are in number of generations per replicate, rather than total number of samples
trace_jc %>%
ggplot(aes(x=Iteration, y=TL, col=Replicate_ID), alpha=0.2) + geom_line()
trace_jc %>%
ggplot(aes(x=Iteration, y=Likelihood, col=Replicate_ID), alpha=0.2) + geom_line()
trace_jc %>%
filter( Iteration > 2500 ) %>%
ggplot(aes(x=Iteration, y=TL, col=Replicate_ID), alpha=0.2) + geom_line()
trace_jc %>%
filter( Iteration > 2500 ) %>%
ggplot(aes(x=Iteration, y=Likelihood, col=Replicate_ID), alpha=0.2) + geom_line()
trace_jc %>%
filter( Iteration > 2500 ) %>%
ggplot(aes(TL, fill = Replicate_ID, colour = Replicate_ID)) +
geom_density(alpha = 0.1)
trace_jc %>%
filter( Iteration > 2500 ) %>%
ggplot(aes(Likelihood, fill = Replicate_ID, colour = Replicate_ID)) +
geom_density(alpha = 0.1)
trace_gtr =
read_tsv("output_gtr/primates_cytb_GTR.log")
trace_gtr %<>%                           # Read the data
mutate(Replicate_ID = as.factor(Replicate_ID))                       # Convert the replicate id to a factor
trace_gtr %>%
ggplot(aes(x=Iteration, y=TL, col=Replicate_ID), alpha=0.2) + geom_line()
trace_gtr =
read_tsv("output_gtr/primates_cytb_GTR.log")
trace_gtr %>%
ggplot(aes(x=Iteration, y=TL), alpha=0.2) + geom_line()
trace_gtr %>%
ggplot(aes(x=Iteration, y=Likelihood), alpha=0.2) + geom_line()
trace_gtr %>%
ggplot(aes(x=Iteration, y=TL), alpha=0.2) + geom_line()
trace_gtr %>%
ggplot(aes(x=Iteration, y=Likelihood), alpha=0.2) + geom_line()
trace_gtrig =
read_tsv("output_gtrig/primates_cytb_GTRGI.log")
trace_gtrig %>%
ggplot(aes(x=Iteration, y=TL), alpha=0.2) + geom_line()
trace_gtrig %>%
ggplot(aes(x=Iteration, y=Likelihood), alpha=0.2) + geom_line()
trace_gtrig %>%
ggplot(aes(x=Iteration, y=Alpha), alpha=0.2) + geom_line()
trace_gtrig %>%
ggplot(aes(x=Iteration, y=alpha), alpha=0.2) + geom_line()
trace_gtr %>%
ggplot(aes(x=Iteration, y=Prior), alpha=0.2) + geom_line()
trace_gtr %>%
ggplot(aes(x=Iteration, y=Likelihood), alpha=0.2) + geom_line()
trace_gtr %>%
ggplot(aes(x=Iteration, y=TL), alpha=0.2) + geom_line()
tinytex::install_tinytex()
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
axis(side = 2, at = round(as.numeric(rownames(counts)), 2), las = 1, cex.axis = 0.8, tck = -0.01)
legend('bottomright', legend = c('1', '2-3', '4-5', '6-10', '11+'),
pch = c(16),
col = c(col.rangechart),
pt.cex = c(1, 1.25, 1.5, 1.75, 2),
ncol = 4, title = 'Tooth Count', title.adj = 0.5, cex = 0.5)
if (save_pdf == TRUE) {
dev.off()
}
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553_1.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
axis(side = 2, at = round(as.numeric(rownames(counts)), 2), las = 1, cex.axis = 0.8, tck = -0.01)
legend('bottomright', legend = c('1', '2-3', '4-5', '6-10', '11+'),
pch = c(16),
col = c(col.rangechart),
pt.cex = c(1, 1.25, 1.5, 1.75, 2),
ncol = 4, title = 'Tooth Count', title.adj = 0.5, cex = 0.5)
if (save_pdf == TRUE) {
dev.off()
}
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553_1.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
?is.unsorted
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
axis(side = 2, at = round(as.numeric(rownames(counts)), 2), las = 1, cex.axis = 0.8, tck = -0.01)
legend('bottomright', legend = c('1', '2-3', '4-5', '6-10', '11+'),
pch = c(16),
col = c(col.rangechart),
pt.cex = c(1, 1.25, 1.5, 1.75, 2),
ncol = 4, title = 'Tooth Count', title.adj = 0.5, cex = 0.5)
if (save_pdf == TRUE) {
dev.off()
}
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553_1.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553_1.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
library(ichthyoliths)
library(viridis)
setwd("/Users/icbissell/Documents/research/Eocene_teeth/code/morph_time")
data <- read.csv("data/ToothMorph_V0.4_Morphotypes - Chas_U1553.csv")
save_pdf <- FALSE
if (save_pdf == TRUE) {
pdf(file = "figures/morph_time.pdf", width = 10, height = 8)
}
df1 <- data[!data$Alias=="",]
#df2 <- cbind(df1$Age, df1$Alias)
df3 <- data.frame(age = df1$Age, morphotype = df1$Alias)
counts <- table(df3)
col.rangechart <- viridis(5)
col.rangechart[1] <- 'gray70'
par(mar = c(12, 5, 3, 3))
# xax<-rangechart(counts, reorder = 'lad.by.fad', normalize.counts = FALSE,
#                 col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5), # 1, 2, 3, 4-5, 6+
#                 cex.points = 'by.count', largesize = 1,
#                 xaxis.labels = 'alphanum', yaxis.ticks = TRUE,
#                 print.xaxis = T, main = '', ylab = 'Age (Ma)')
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
axis(side = 2, at = round(as.numeric(rownames(counts)), 2), las = 1, cex.axis = 0.8, tck = -0.01)
legend('bottomright', legend = c('1', '2-3', '4-5', '6-10', '11+'),
pch = c(16),
col = c(col.rangechart),
pt.cex = c(1, 1.25, 1.5, 1.75, 2),
ncol = 4, title = 'Tooth Count', title.adj = 0.5, cex = 0.5)
if (save_pdf == TRUE) {
dev.off()
}
is.unsorted(ages)
xax<-rangechart(counts, reorder = 'fad.by.lad', normalize.counts = TRUE,
col.points = 'by.count', cols.vec = col.rangechart, count.breaks = c(0, 1, 3, 5, 7, 10), # 1, 2, 3, 4-5, 6+
cex.points = 'by.count', largesize = 1,
xaxis.labels = 'names', yaxis.ticks = TRUE,
print.xaxis = T, main = '', ylab = 'Age (Ma)', cex.yaxis = 0.8, cex.xaxis = 0.75)
